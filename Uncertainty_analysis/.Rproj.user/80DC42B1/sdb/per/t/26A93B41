{
    "contents" : "# looking at which cores for which we have measurements\n# FOR CHRISTY: what about the cores where we don't have any data?  Will that be added later?\ncores.meas <- as.vector(colnames(core.rw))\ncores.meas[1:10] # checking names\nlength(cores.meas) # checking size\n#this is looking at which trees we have measurements for (1,6) translates to AAA000 six characters\n\n\n#This is commented out becasue we have a dated column in our core.data csv file\n# Making a binary column of whether the tree was dated or not\n#for(i in 1:length(diam.data$TreeID)){\n#  diam.data$Dated[i] <- ifelse(diam.data$TreeID[i] %in% mmf.id2, \"YES\", \"NO\")\n#}\n#diam.data$Dated <- as.factor(diam.data$Dated) # making a factor (because sometimes goes weird)\n#diam.data$Spp.Dated <- as.factor(paste(diam.data$spp, diam.data$Dated, sep=\".\")) # don't worry about this (something I\"m playing with)\n#summary(diam.data)\n\nnames(core.data)\nsummary(core.data)\ncore.deets <- data.frame(names(core.rw)) \nnames(core.deets) <- \"ID\"\nsummary(core.deets)\n\nnames(core.data)\n\n# Associating dbh with coreID\nfor(i in unique(core.deets$ID)){\n  core.deets[core.deets$ID==i, \"DBH\"] <- core.data[core.data$CoreID==i,\"dbh\"]\n}\nsummary(core.deets)\n\n\n\n#subsetting the DBH list to match what cores were actually dated\n#core.names <- names(all.dated2)\n\n#ID2 <- ID[ID$ID %in% core.names,]\n\n#order both Core details object we just made, and the uploaded TR measurements\ncore.deets <- core.deets[order(core.deets$ID),]\nhead(core.deets)\n#Flipping the dataset so that it has the most recent year at the top\ncore.rw <- core.rw[order(row.names(core.rw), decreasing=T),order(names(core.rw))]\nhead(core.rw)\nncol(core.rw)\n\n#order both tree details object we just made, and the uploaded TR measurements\ntree.deets <- tree.deets[order(tree.deets$ID),]\nhead(tree.deets)\n#Flipping the dataset so that it has the most recent year at the top\ntree.rw <- tree.rw[order(row.names(tree.rw), decreasing=T),order(names(tree.rw))]\nhead(tree.rw)\nncol(tree.rw)\n\n# ----------------------------------------------------------------------------\n\n#making dataframe of tree diameter\ntree.deets <- data.frame(names(tree.rw)) \nnames(tree.deets) <- \"ID\"\nsummary(tree.deets)\n\nnames(core.data)\n\n# Getting tree level data\nfor(i in unique(tree.deets$ID)){\n  tree.deets[tree.deets$ID==i, \"DBH\"] <- tree.data[tree.data$TreeID==i,\"dbh\"]\n}\nsummary(tree.deets)\n\n\n#diameter reconstructions of each tree from the trees that dated??\ndbh.recon <- tree.rw\nsummary(dbh.recon)\nsummary(tree.deets)\nfor(j in seq_along(dbh.recon)){\n  # inserting 2012 DBH\n  dbh.recon[1,j] <- tree.deets[tree.deets$ID==names(dbh.recon[j]),\"DBH\"] \n  for(i in 2:(length(dbh.recon[,j]))){\n    dbh.recon[i,j] <- ifelse(!is.na(tree.rw[i,j]), dbh.recon[i-1,j] - tree.rw[i-1,j]*2, tree.rw[i,j]*2) # subtracting the previous year's growth from DBH to get that year's DBH\n  }\n}\nsummary(dbh.recon)\nmin(dbh.recon, na.rm=T)\n\n\n#quick plot\nspag.plot(dbh.recon)\nplot.rwl(dbh.recon)\n\n\n\n#checking for negative diameters that will need to be removed or switch to inside out orientation (call Christy)\n#RA: WE NOW HAVE A NEGATIVE NUMBER IN THE DIAMETER RECONSTRCUTIONS\n\nmin(dbh.recon, na.rm=T)\nsummary(dbh.recon)\nwrite.csv(dbh.recon, \"DOE_dbh_recon.csv\")\n\n##########################################################################\n#using ring widths to caclulate a Basal Area Increment (BAI)\n# FOR CHRISTY: IS THIS WHERE THIS SHOULD GO?\n##########################################################################\n\ntree.bai.out <- bai.out(tree.rw, diam=tree.deets)\nsummary(tree.bai.out)\nmin(tree.bai.out, na.rm=T)\n\n# FOR CHRISTY: I think I have things working.  Would you mind doind a quick double check over these scripts before you use them to do the next step?",
    "created" : 1423750831083.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3495480649",
    "id" : "26A93B41",
    "lastKnownWriteTime" : 1423750846,
    "path" : "~/PhD/Carbon Research/Tree-rings-to-biomass/Uncertainty_analysis/diameter_recon.R",
    "project_path" : "diameter_recon.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}